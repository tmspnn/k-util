!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.kutil=e():t.kutil=e()}(this,(function(){return(()=>{"use strict";var t={d:(e,n)=>{for(var s in n)t.o(n,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:n[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function n(t,e){if(t instanceof Object){const n=e.toString().match(/[^\.\[\]\'\"]+/g);if(n)return n[0]=t[n[0]],n.reduce(((t,e)=>t instanceof Object?t[e]:null))}return null}t.d(e,{default:()=>d});const s=Object.assign,i=Object.getPrototypeOf,o=Object.setPrototypeOf;function r(t,e){return function(...n){s(this,t),e&&(this.Super=function(...t){this.super=new e(...t),o(i(this),this.super)}),t.hasOwnProperty("constructor")?t.constructor.call(this,...n):this.Super&&this.Super()}}const a=r({subscriptions:{},on(t,e,n){const s={listener:e,context:n};this.subscriptions[t]?this.subscriptions[t].push(s):this.subscriptions[t]=[s]},off(t,e,n){this.subscriptions[t]&&(e?this.subscriptions[t].forEach(((s,i)=>{s&&s.listener==e&&s.context==n&&(this.subscriptions[t][i]=null)})):delete this.subscriptions[t])},emit(t,...e){this.subscriptions[t]&&this.subscriptions[t].forEach((t=>{t&&t.listener.call(t.context,...e)}))}});function c(t,e,n){if(t instanceof Object){const s=e.toString().match(/[^\.\[\]\'\"]+/g);if(s){let e=t;return s.forEach(((t,i)=>{i==s.length-1?e[t]=n:(e[t]instanceof Object||(e[t]={}),e=e[t])})),t}}return null}const h=new a,l=Object.assign,u=Object.keys,f=Array.isArray,p=r({namespace:"global",name:"",element:null,refs:{},data:null,bindings:{},constructor(){this.namespace=location.href},bindData(t){t&&(this.data?l(this.data,t):this.data=t),this.element&&this._createBindings(this.element)},setData(t,e){"string"==typeof t?("function"==typeof e?e(this.data[t]):this.data[t]=e,this._onDataUpdate(t)):t instanceof Object&&(l(this.data,t),this._onDataUpdate(u(t)))},dispatch(t,...e){const n=t.split("."),s=n[0],i=n[1];h.emit(this.namespace+"::"+s,i,...e)},listen(){h.on("global",this.onBroadcast,this),h.on(this.namespace+"::"+this.name,this._eventHandler,this)},destroy(){document.documentElement.contains(this.element)&&(this.element.parentNode.removeChild(this.element),this.element=null),h.off("global",this.onBroadcast,this),h.off(this.namespace+"::"+this.name,this._eventHandler,this)},broadcast(...t){h.emit("global",...t)},onBroadcast(){},_eventHandler(t,...e){console.log("name: ",this.name),console.log("method: ",t),"function"==typeof this[t]&&this[t].call(this,...e)},_createBindings(t){for(let e in t.dataset)if(t.dataset.hasOwnProperty(e))switch(e){case"ref":this.refs[t.dataset.ref]=t;break;case":":t.dataset[":"].split(";").forEach((e=>{const s=e.split(":").map((t=>t.trim())),i=s[0],o=s[1];if(!o)return;let r;r="@"==i[0]?()=>this[i.slice(1)]():()=>c(t,i,n(this.data,o));const a=o.match(/[^\.[]+/)[0];this.bindings[a]?this.bindings[a].push(r):this.bindings[a]=[r]}));break;case"on":t.dataset.on.split(";").forEach((e=>{const n=e.split(":").map((t=>t.trim())),s=n[0],i=n[1];s&&"function"==typeof this[i]&&t.addEventListener(s,this[i].bind(this))}))}for(let e=0;e<t.children.length;++e)this._createBindings(t.children[e])},_onDataUpdate(t){"string"==typeof t?this._mutate(t):f(t)&&t.forEach((t=>this._mutate(t)))},_mutate(t){const e=this.bindings[t];e&&e.forEach((t=>t()))}}),d={at:n,each:function(t,e){if(t.length)for(let n=0;n<t.length;++n)e(t[n],n);else for(let n in t)t.hasOwnProperty(n)&&e(t[n],n)},Ee:a,int:function(t){return t?0|+t:0},isBrowser:function(){return new Function("try {\n      return this == window;\n    } catch (e) {\n      return false;\n    }")()},Klass:r,parseJSON:function(t){try{return JSON.parse(t)}catch(t){return null}},put:c,toArray:function(t){return Array.prototype.slice.call(t)},View:p};return e.default})()}));